# Pflichtenheft  

## 1. Ziel und Zweck
Ziel des Systems ist die Steuerung der **Schneidegeschwindigkeit einer Brotschneidemaschine** mit zustandsbasierter Wartungslogik.  
Das System steuert die Drehzahl des Schneidemotors in definierten Stufen, überwacht die Betriebsgrößen und protokolliert den Maschinenzustand.  
Nach einer festgelegten kumulierten Laufzeit wird ein Wartungshinweis ausgegeben, um Verschleiß frühzeitig zu erkennen.  

---

## 2. Ausgangsbasis
**Referenz:** Lastenheft „Brotschneidemaschine – Schneidegeschwindigkeitssteuerung“  
**Grundlagen:**  
- EN ISO 13849-1 (Sicherheitsanforderungen an Steuerungen)  
- Anforderungen an elektrische Antriebssteuerungen für Schneidemaschinen  
- Implementierung in C++ auf Mikrocontrollerbasis (STM32-Plattform)  

---

## 3. Systemübersicht

### 3.1 Funktionsblöcke
- **TF-01 Schneidemotor- und Geschwindigkeitssteuerung**  
- **TF-02 Monitoring der Betriebsgrößen**  
- **TF-03 Wartungsmanagement**  
- **TF-04 Protokollierung und Datenspeicherung**  
- **TF-05 Systemlogik und Betriebszustände**

### 3.2 Systemgrenzen
- Das System steuert ausschließlich den **Schneidemotor** der Brotschneidemaschine.  
- Keine Ansteuerung von Fördermechanismen oder anderer Maschinenachsen.  
- Kommunikation beschränkt sich auf Bedienbefehle, Messwerte und interne Datenspeicherung.

---

## 4. Anforderungen

### 4.1 Funktionale Requirements

| Nr. | Beschreibung | Umsetzung in Teilfunktion |
|-----|---------------|----------------------------|
| **F1** | Einstellung der Schneidegeschwindigkeit in 10 %-Schritten (0–100 %), Aktualisierung des Istwerts ≤ 1 s | TF-01 |
| **F2** | Auslösung des Not-Halt-Befehls führt innerhalb von 100 ms zum sicheren Stillstand der Schneide | TF-01 |
| **F3** | Erfassung der Stromaufnahme des Schneidemotors alle 500 ms und Berechnung eines gleitenden Mittelwerts über 5 Messpunkte | TF-02 |
| **F4** | Generierung eines Wartungshinweises nach 48 h kumulierter Laufzeit; Testmodus erlaubt verkürztes Intervall | TF-03 |
| **F5** | Durchführung einer zyklischen Protokollierung (1 Hz) von Zeit, Sollwert, Istwert, Stromaufnahme und Systemzustand in einer CSV-Datei | TF-04 |

---

### 4.2 Nicht-funktionale Requirements

| Nr. | Beschreibung | Kategorie | Betroffene Teilfunktionen |
|-----|---------------|------------|----------------------------|
| **NF1** | Implementierung in C++ für Zielplattform STM32 (ARM Cortex-M) | Plattform | alle |
| **NF2** | Reaktionszeit auf Bedienbefehle ≤ 200 ms | Performance | TF-01, TF-05 |
| **NF3** | Sicherstellung deterministischer Ausführung durch feste Zykluszeiten (100 ms) | Zuverlässigkeit | TF-05 |
| **NF4** | Begrenzung der CSV-Dateigröße auf 1 MB mit automatischer Neuerstellung | Robustheit | TF-04 |
| **NF5** | Definition und Protokollierung der Betriebszustände RUN, STOP, FAULT mit eindeutiger Kennzeichnung im Log | Nachvollziehbarkeit | TF-05 |
| **NF6** | Genauigkeit der Drehzahlanzeige ± 5 % Sollwertabweichung | Qualität / Genauigkeit | TF-01 |
| **NF7** | Sicherstellung des Systembetriebs im Temperaturbereich 0–45 °C | Umwelt / Betrieb | alle Hardware-nahen Komponenten |

---

## 5. Teilfunktionalitäten

| Nr. | Bezeichnung | Beschreibung | Zugeordnete Requirements |
|-----|--------------|---------------|----------------------------|
| **TF-01** | Schneidemotor- und Geschwindigkeitssteuerung | Umsetzung der Sollgeschwindigkeit in 10 %-Schritten sowie sichere Abschaltung bei Not-Halt | F1, F2, NF2, NF6 |
| **TF-02** | Monitoring der Betriebsgrößen | Erfassung und Mittelwertbildung der Stromaufnahme zur Zustandsüberwachung des Schneidemotors | F3, NF3 |
| **TF-03** | Wartungsmanagement | Ermittlung der kumulierten Laufzeit und Auslösung eines Wartungshinweises nach 48 h Betrieb | F4 |
| **TF-04** | Protokollierung und Datenspeicherung | Zyklische Aufzeichnung von Sollwert, Istwert, Stromaufnahme und Zustand in einer CSV-Datei | F5, NF4 |
| **TF-05** | Systemlogik und Betriebszustände | Verwaltung der Zustände RUN, STOP, FAULT und Koordination aller Teilfunktionen | F1–F5, NF1, NF3, NF5, NF7 |

---

## 6. Schnittstellen

| Schnittstelle | Richtung | Beschreibung |
|----------------|-----------|---------------|
| Bedienung ↔ Steuerlogik | bidirektional | Übergabe von Start-/Stop-/Not-Halt-Befehlen und Rückmeldung des Betriebszustands |
| Sensorik ↔ Monitoring | unidirektional | Übertragung der Stromaufnahmedaten an das Monitoring-Modul |
| Monitoring ↔ Wartungsmanagement | unidirektional | Bereitstellung der Betriebszeit- und Stromdaten zur Laufzeitbewertung |
| Logik ↔ Protokollierung | bidirektional | Übergabe von Zustands- und Prozessdaten an Logging-Funktion |
| Safety-Signal ↔ Geschwindigkeitssteuerung | unidirektional | Not-Halt-Signal für sofortiges Stillsetzen des Schneidemotors (≤ 100 ms) |

---

## 7. Tests und Verifikation
- **Funktionstest:** Prüfung aller Soll-/Ist-Geschwindigkeiten und Reaktionszeiten  
- **Safety-Test:** Nachweis des sicheren Stillstands ≤ 100 ms nach Not-Halt  
- **Timing-Test:** Verifikation der Zykluszeit von 100 ms und Reaktionszeit ≤ 200 ms  
- **Monitoring-Test:** Überprüfung der Mittelwertbildung (5 Messpunkte / 500 ms-Intervall)  
- **Wartungstest:** Simulation des Erreichens von 48 h kumulierter Laufzeit und Auslösung des Wartungshinweises  
- **Logging-Test:** Kontrolle der CSV-Dateistruktur und Größenbegrenzung auf 1 MB  
- **Zustandstest:** Validierung der Zustandsübergänge RUN ↔ STOP ↔ FAULT und deren korrekte Protokollierung  
- **Temperaturtest:** Funktionstest im Temperaturbereich 0–45 °C gemäß NF7  
- **Genauigkeitstest:** Vergleich Soll-/Ist-Drehzahlabweichung gemäß NF6 (±5 %)  
